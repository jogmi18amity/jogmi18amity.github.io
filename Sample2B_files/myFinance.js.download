!function(){function e(e){var t=document.createElement("div");t.className="myFinance-ad-unit",e.style_class_name&&(t.className+=" "+e.style_class_name),e.widget_uuid&&t.setAttribute("data-widget-id",e.widget_uuid),t.setAttribute("data-campaign",e.campaign.url_param);var n=null;return e.selector&&(n=document.querySelector(e.selector)),[t,n]}function t(e,t){return e.textContent.toLowerCase().includes(t.toLowerCase())}function n(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}function i(e){return!!e&&({BLOCKQUOTE:!0,DL:!0,H1:!0,H2:!0,H3:!0,H4:!0,H5:!0,H6:!0,OL:!0,P:!0,PRE:!0,UL:!0}[e.tagName]||!1)}function r(e){for(var t=i(e),n=e.nextElementSibling;t&&n;)t=!i(n),n=n.nextElementSibling;return t}function o(e,t){for(var o,a=4;a>=0;){if(!e)return T.log.log("%cRan out of elements looking for a valid target element.","font-weight: bold; color: #cf4931"),null;for(o=e.nextElementSibling;o&&!n(o);)o=o.nextElementSibling;if(T.isCNNMoney()&&"timestamp"===o.className)return T.log.log('%cOn CNN Money Page with next element containing class "timestamp.',"font-weight: bold; color: #cf4931"),null;if(i(e)&&i(o))return e;if(r(e))return e;if(t)return T.log.log("%cMultiple Ad Units and current target is not the last element and next element is not a text element.","font-weight: bold; color: #cf4931"),null;e=o,a--}return T.log.log("%cExceeded travel buffer while looking for a valid target element.","font-weight: bold; color: #cf4931"),null}function a(e,n){var i=e.search_phrase;if(i){var r=e.selector,a="p";if(r){var c=r.split(" ");a=c[c.length-1].split(":")[0].split(".")[0]}for(var s=document.getElementsByTagName(a),l=null,d=0;d<s.length;d++)if(t(s[d],i)&&(l=o(s[d],n)))return l;T.log.log("%cSearch Phrase %c"+i+" %cnot found searching %c<"+a+"> %celements","font-weight: bold; color: #cf4931","color: black","font-weight: bold; color: #cf4931","color: black","font-weight: bold; color: #cf4931")}else T.log.log("%cNo Search Phrase","font-weight: bold");return null}function c(e,t){t.parentNode.insertBefore(e,t.nextSibling)}function s(e,t,n,i){var r=e.parentNode;n.insert_before?r.insertBefore(t,e):c(t,e);var o=new p(t,n,i);return o.trackPageView(),o}function l(e){for(var t=[];e.parentNode;){if(e.id){t.unshift("#"+e.id);break}if(e==e.ownerDocument.documentElement)t.unshift(e.tagName);else{for(var n=1,i=e;i.previousElementSibling;i=i.previousElementSibling,n++);t.unshift(e.tagName+":nth-child("+n+")")}e=e.parentNode}return t.join(" > ")}function d(e,n,i,r){var o,c=e[0],d=e[1];if(!d||n.search_phrase&&!t(d,n.search_phrase)){T.log.groupCollapsed("%cembed Issue","color: #cf4931"),o=a(n,i);var u,m={selector:n.selector?n.selector:""};o?(n.selector&&(n.updatedSelector=l(o)),m.message="Dynamically Placed",u=s(o,c,n,r)):(m.message="Failed to Embed",u=new p(null,n,r)),!n.selector&&o||(n.selector||(n.updatedSelector="DYNAMIC - placement not valid"),u.trackAdUnitEmbedError()),m.campaign=n.campaign,T.log.logEntry(m),T.log.groupEnd()}else s(d,c,n,r)}function u(t){var n=JSON.parse(t),i=n.ad_units,r=i.length>1,o=[];T.log.logGroup("adUnits",i);for(var a=0;a<i.length;a++)o.push(e(i[a]));for(a=0;a<o.length;a++)d(o[a],i[a],r,n.tracking)}function m(){(new p).trackScriptExecution()}function p(e,t,i){this._postsEndpoint="https://www.myfinance.com/api/promoted_pages",e&&(this._container=e,this._type=e.getAttribute("data-type")||"horizontal",this._style=e.getAttribute("data-style")||"images",this._campaign=e.getAttribute("data-campaign")||"other",this._placement=e.getAttribute("data-placement")||null,this._widget_id=e.getAttribute("data-widget-id")||null,this._visible=n(this._container),this._shouldWriteHTML="other"!==this._campaign,this._noEvents=e.getAttribute("data-no-events")||!1,this._foreignReferrer=e.getAttribute("data-foreign-referrer")||null),this._analytics_key="yuH27H1QId6afXAojow6Tafi7Vw9v1spaLD5Yznw",this._page={protocol:window.location.protocol||"",domain:window.location.host||"",path:window.location.pathname||"",referrer:document.referrer||"",search:window.location.search||"",title:document.title||"",url:window.location.protocol+"//"+window.location.host+window.location.pathname||""},this._campaignObj={medium:y("utm_medium")||"",name:y("utm_campaign")||"",source:y("utm_source")||""},t&&(this._adUnit=t,this._campaign=this._campaign||t.campaign.url_param,this._widget_id=this._widget_id||t.widget_uuid,this._htmlSnippet=t.html_snippet||null,this._MF=i),e&&(this._widget_id||this._htmlSnippet)?(this._shouldWriteHTML=!0,T.log.groupCollapsed("adPlacement"),t&&T.log.logGroup("campaign",t.campaign),this.writeHTML(),T.log.groupEnd()):e&&this.init()}function g(){var e=h("_mfuuid_");if(e)var t=e;else{var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)});f("_mfuuid_",t,365)}return t}function f(e,t,n){if(n){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var r="; expires="+i.toGMTString()}else var r="";document.cookie=e+"="+t+r+"; path=/"}function h(e){for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return r.substring(t.length,r.length)}return null}function _(e,t){var n=new RegExp("(?:^|\\s)"+t+"(?!\\S)");return!!e.className.match(n)}function y(e){for(var t=window.location.search.substring(1),n=t.split("&"),i=0;i<n.length;i++){var r=n[i].split("=");if(decodeURIComponent(r[0])==e)return decodeURIComponent(r[1])}}function w(e){var t=e.getBoundingClientRect(),n=window.innerHeight||document.documentElement.clientHeight,i=window.innerWidth||document.documentElement.clientWidth,r=Math.max(t.top,0),o=Math.min(t.bottom,n),a=Math.max(t.left,0),c=Math.min(t.right,i),s=t.top>=0&&t.bottom<=n,l=o-r>=300,d=t.left>=0&&t.right<=i,u=c-a>=300;return(s||l)&&(d||u)}function v(){return window.location.href.split(/[?#]/)[0]}function b(){return"money.cnn.com"===window.location.hostname}function x(e){e.properties.campaign="",e.properties.campaign_id=null,e.properties.campaign_reporting_id=""}function k(){return{pageImpressionByCampaign:{}}}function E(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),i=n.exec(t);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function F(){return E("mf_foreign_referrer")||document.referrer}function M(){var e=Array.prototype.slice.call(arguments);window.postMessage({type:"MY_FINANCE_Log",text:e.join("::")},"*")}function C(){var e=Array.prototype.slice.call(arguments);window.postMessage({type:"MY_FINANCE_GroupCollapsed",text:e.join("::")},"*")}function R(){window.postMessage({type:"MY_FINANCE_GroupEnd",text:""},"*")}function I(e){window.postMessage({type:"MY_FINANCE_Count",text:e},"*")}function N(e,t){C("%canalytics - "+e.event,"color: #3139f2"),e.properties.campaign_reporting_id&&I("reporting_id - "+e.properties.campaign_reporting_id);var n={mf_event_id:e.properties.mf_event_id,campaign:{name:e.properties.campaign,id:e.properties.campaign_id,reporting_id:e.properties.campaign_reporting_id,widget_uuid:e.properties.widget_uuid}};t&&(t.hasOwnProperty("updatedSelector")?n.selector=t.updatedSelector:n.selector=t.selector),e.properties.hasOwnProperty("click_target")&&(n.click_target=e.properties.click_target),O("event",n),R()}function S(e){for(var t in e)if(e.hasOwnProperty(t)){var n=e[t];"object"==typeof n?(C(t),S(n),R()):M("%c"+t+": ","font-weight: bold;",n)}}function O(e,t){C(e),S(t),R()}var A={};this.__createMFWidgets__=function(){var e=T.getPageURL();if(!A[e]){A[e]=T.pageEventsTemplate(),m();for(var t=document.body.querySelectorAll(".myFinance-widget"),n=T.getParameterByName("mf_ct_campaign"),i=0;i<t.length;i++){var r=t[i];n&&(r.setAttribute("data-campaign",n),r.setAttribute("data-no-events","true"),r.setAttribute("data-foreign-referrer",T.getReferrerURL()));new p(r).trackPageView()}var o=["tzo="+(new Date).getTimezoneOffset(),"w="+screen.width,"h="+screen.height,"mf_referrer="+encodeURIComponent(T.getPageURL()),"utm_medium=embed"],a="https://www.myfinance.com/api/ad_units?"+o.join("&");p.prototype.ajax("GET",a,u,null)}},p.prototype.init=function(){var e=["utm_campaign="+this._campaign,"tzo="+(new Date).getTimezoneOffset(),"w="+screen.width,"h="+screen.height,"mf_referrer="+encodeURIComponent(T.getPageURL()),"utm_medium=CRU"],t=this._postsEndpoint+"?"+e.join("&");this.ajax("GET",t,this.writeHTML,null)},p.prototype.uuid4=function(){var e,t="";for(e=0;e<32;e+=1)switch(e){case 8:case 20:t+="-",t+=(16*Math.random()|0).toString(16);break;case 12:t+="-",t+="4";break;case 16:t+="-",t+=(4*Math.random()|8).toString(16);break;default:t+=(16*Math.random()|0).toString(16)}return t},p.prototype.writeHTML=function(e){function t(e){e.preventDefault();var t=document.body.querySelector(".myFinance-widget__modal");t&&(t.style.display="block")}function n(e){if(!_(e.target,"myFinance-widget__modal-content")){document.body.querySelector(".myFinance-widget__modal").style.display="none"}}var i,r=[],o=[],a={};if(e){var c=JSON.parse(e);r=c.posts,o=c.rendered_crus||[],i=c.nf||!1,this._posts=r,this._MF=c.tracking,a.campaign={id:this._MF.campaign_id,name:this._MF.campaign,url_param:this._MF.campaign_url_param,reporting_id:this._MF.campaign_reporting_id}}var s=null;if(this._shouldWriteHTML){var l=this._container;if(this._widget_id){this._adUnit&&this._adUnit.hasOwnProperty("selector")&&T.log.logEntry({selector:this._adUnit.selector}),a.widget_id=this._widget_id,T.log.logGroup("iframe",a);var d=document.createElement("iframe"),u=["utm_campaign="+this._campaign,"utm_medium=embed"];this._foreignReferrer&&u.push("foreign_referrer="+encodeURIComponent(this._foreignReferrer)),d.src="https://www.myfinance.com/w/"+this._widget_id+"?"+u.join("&"),d.frameBorder=0,d.scrolling="no",d.className="myFinance-iframe";var m=this;d.onload=function(){iFrameResize({messageCallback:function(e){e.iframe==d&&"widgetClick"==e.message&&m.trackRecommendationClick()}},d)},l.appendChild(d)}else if(this._htmlSnippet)a.selector=this._adUnit.selector,a.htmlSnippet=this._htmlSnippet,T.log.logGroup("htmlSnippet",a),l.className="myFinance-custom-template-ad-unit",l.innerHTML=this._htmlSnippet,l.addEventListener("click",this.trackRecommendationClick.bind(this));else if(o.length>0){a.renderedCRU=o.length,T.log.logGroup("renderedCRU",a);var p,g;for(p=0;p<o.length;p++)if(g=o[p],l.id===g.identifier){l.innerHTML=g.rendered_cru,l.classList.remove("myFinance-widget"),l.addEventListener("click",this.trackRecommendationClick.bind(this));break}}else{a.posts=r.length,T.log.logGroup("generatedCRU",a),l.innerHTML='<h2 class="myFinance-widget__title">Recommended</h2>';var f=4;r.length%3==0&&"horizontal"===this._type&&(f=3,l.className+=" is-thirds");var h=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;h<=544&&"horizontal"===this._type&&(this._type="vertical"),l.className+=" is-"+this._type;var y=document.createElement("div");y.className="myFinance-widget__posts-container";var w,v,b,x,k,E;for(w=0;w<r.length;w+=f){for(b=r.slice(w,w+f),x=document.createElement("div"),x.className="myFinance-widget__posts-row",v=0;v<b.length;v++){switch(k=document.createElement("a"),this._type){case"vertical":E='<img class="myFinance-widget__post-image" data-pin-nopin="true" src="'+b[v].related_image_wide+'"/><div class="myFinance-widget__post-caption">'+b[v].headline+"</div>";break;case"horizontal":E='<img class="myFinance-widget__post-image" data-pin-nopin="true" src="'+b[v].related_image+'"/><div class="myFinance-widget__post-caption">'+b[v].headline+"</div>";break;case"text":E='<div class="myFinance-widget__post-caption">'+b[v].headline+"</div>"}k.innerHTML=E,k.className="myFinance-widget__post",k.href=b[v].url,k.setAttribute("target","_blank"),i&&k.setAttribute("rel","nofollow"),k.addEventListener("click",this.trackRecommendationClick.bind(this,b[v])),x.appendChild(k)}y.appendChild(x)}l.appendChild(y),s=function(e){var n=document.createElement("div"),i=document.createElement("a");return i.href="#",i.className="myFinance-widget__attribution-logo-link",i.innerHTML='<img src="https://www.myfinance.com/static/img/myfinance-logo-white.svg" class="myFinance-widget__attribution-logo"/>',i.addEventListener("click",t),n.innerHTML=e,n.className="myFinance-widget__attribution",n.appendChild(i),n}("Recommendations by ")}var F=function(){var e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("div");return e.className="myFinance-widget__modal",e.style.position="fixed",e.style.top=0,e.style.left=0,e.style.right=0,e.style.bottom=0,e.style.width="100%",e.style.height="100%",e.style.background="transparent",e.style.zIndex="1000000000",e.style.display="none",t.className="myFinance-widget__modal-body",t.innerHTML='<div class="mfFinance-widget__modal-content"><h3 class="myFinance-widget__modal-heading">Powered by</h3><a href="https://www.myfinance.com" target="_blank"><img src="https://www.myfinance.com/static/img/myfinance-logo-white.svg" class="myFinance-widget__modal-logo"/></a><p class="myFinance-widget__modal-text">For partnership opportunities contact <a href="mailto:help@myfinance.com" target="_blank">help@myfinance.com</a></p><p class="myFinance-widget__modal-text">To view our privacy policy <a href="https://www.myfinance.com/p/privacy-policy/" target="_blank">click here</a></p></div>',i.className="myFinance-widget__modal-x",i.innerText="+",t.appendChild(i),e.appendChild(t),e.addEventListener("click",n),e}();s&&(l.appendChild(s),l.appendChild(F)),this.trackImpression()}},p.prototype.ajax=function(e,t,n,i){var r=new XMLHttpRequest,o=this;n&&(r.onreadystatechange=function(){r.readyState==r.DONE&&n.apply(o,[r.response])}),r.open(e,t,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Accept","application/json"),r.setRequestHeader("x-api-key",o._analytics_key),r.send(i)},p.prototype.trackImpression=function(){function e(){if(w(t._container)){window.clearInterval(n);var e=t.getAnalyticsObject("widget-impression");t.sendAnalyticsEvent(e)}}if(this._visible){var t=this,n=window.setInterval(e,1e3);e()}},p.prototype.trackPageView=function(){function e(){if(t._MF){window.clearInterval(n);var e;t._shouldWriteHTML&&(e=t.getAnalyticsObject("widget-pageview"),t.sendAnalyticsEvent(e));var i=A[T.getPageURL()],r=i&&i.pageImpressionByCampaign||{};e=t.getAnalyticsObject("page-level-impression"),r[e.properties.campaign_reporting_id]||(t.trackPageImpression(e),r[e.properties.campaign_reporting_id]=!0),T.unsetCampaign(e),r[e.properties.campaign_reporting_id]||(t.trackPageImpression(e),r[e.properties.campaign_reporting_id]=!0)}}if(this._visible){var t=this,n=window.setInterval(e,1e3);e()}},p.prototype.trackPageImpression=function(e){this.sendAnalyticsEvent(e)},p.prototype.trackRecommendationClick=function(e){var t=this;if(t._MF){var n=t.getAnalyticsObject("widget-recommendation-click");e&&(n.properties.click_target={post_id:e.id,headline_id:e.headline_id,image_id:e.image_id}),t.sendAnalyticsEvent(n)}},p.prototype.trackAdUnitEmbedError=function(){var e=this.getAnalyticsObject("ad-unit-embed-error");this.sendAnalyticsEvent(e)},p.prototype.trackScriptExecution=function(){var e=this.getAnalyticsObject("embed-script-execution");this.sendAnalyticsEvent(e)},p.prototype.sendAnalyticsEvent=function(e){this.hasOwnProperty("_adUnit")?N(e,this._adUnit):N(e),this._noEvents||this.ajax("POST","https://analytics.myfinance.com/prod/record",null,JSON.stringify(e))},p.prototype.getAnalyticsObject=function(e){var t=g(),n=this.uuid4(),i=this._campaignObj,r=this._page,o=this._MF||{},a=this._posts,c=this._adUnit,s={type:"track",messageId:n,timestamp:(new Date).toISOString(),anonymousId:t,userId:null,event:e,writeKey:this._key,context:{campaign:{medium:i.medium,name:i.name,source:i.source},page:{path:r.path,referrer:r.referrer,search:r.search,title:r.title,url:r.url},userAgent:o.user_agent||"",ip:o.ip_address||""},properties:{mf_event_id:n,campaign:o.campaign||"",campaign_id:o.campaign_id||"",campaign_reporting_id:o.campaign_reporting_id||"",widget_uuid:this._widget_id||"",country:o.country||"",state:o.state||"",city:o.city||"",postal_code:o.postal_code||"",ip_address:o.ip_address||"",initial_referrer:o.initial_referrer||"",landing_page:o.landing_page||"",num_pages_viewed:o.num_pages_viewed||1,placement_name:o.placement_name||"",user_agent:o.user_agent||"",value:o.value||"",protocol:r.protocol,domain:r.domain,device_brand:o.device_brand||"",device_family:o.device_family||"",device_model:o.device_model||"",os_family:o.os_family||"",os_version_major:o.os_version_major||"",os_version_minor:o.os_version_minor||"",browser_family:o.browser_family||"",browser_version_major:o.browser_version_major||"",browser_version_minor:o.browser_version_minor||"",screen_width:screen.width||"",screen_height:screen.height||"",tz_offset:(new Date).getTimezoneOffset()}};if(a){s.properties.posts=[];var l;for(l=0;l<a.length;l++){var d=a[l];s.properties.posts.push({post_id:d.id,headline_id:d.headline_id,image_id:d.image_id})}}return c&&(s.properties.ad_unit=c.name,s.properties.ad_unit_id=c.id,s.properties.ad_unit_selector=c.selector,s.properties.ad_unit_updated_selector=c.updatedSelector||"",s.properties.campaign=c.campaign.name,s.properties.campaign_id=c.campaign.id,s.properties.campaign_reporting_id=c.campaign.reporting_id),s};var T={getPageURL:v,isCNNMoney:b,unsetCampaign:x,pageEventsTemplate:k,getParameterByName:E,getReferrerURL:F,log:{log:M,logGroup:O,logEntry:S,groupCollapsed:C,groupEnd:R,count:I}}}(),window.__createMFWidgets__(),function(e){"use strict";function t(t,n,i){"addEventListener"in e?t.addEventListener(n,i,!1):"attachEvent"in e&&t.attachEvent("on"+n,i)}function n(t,n,i){"removeEventListener"in e?t.removeEventListener(n,i,!1):"detachEvent"in e&&t.detachEvent("on"+n,i)}function i(){var t,n=["moz","webkit","o","ms"];for(t=0;t<n.length&&!z;t+=1)z=e[n[t]+"RequestAnimationFrame"];z||c("setup","RequestAnimationFrame not supported")}function r(t){var n="Host page: "+t;return e.top!==e.self&&(n=e.parentIFrame&&e.parentIFrame.getId?e.parentIFrame.getId()+": "+t:"Nested host page: "+t),n}function o(e){return T+"["+r(e)+"]"}function a(e){return j[e]?j[e].log:S}function c(e,t){d("log",e,t,a(e))}function s(e,t){d("info",e,t,a(e))}function l(e,t){d("warn",e,t,!0)}function d(t,n,i,r){!0===r&&"object"==typeof e.console&&console[t](o(n),i)}function u(i){function r(){function e(){y(z),f(P)}o("Height"),o("Width"),w(e,z,"init")}function o(e){var t=Number(j[P]["max"+e]),n=Number(j[P]["min"+e]),i=e.toLowerCase(),r=Number(z[i]);c(P,"Checking "+i+" is in range "+n+"-"+t),n>r&&(r=n,c(P,"Set "+i+" to min value")),r>t&&(r=t,c(P,"Set "+i+" to max value")),z[i]=""+r}function a(e){return O.substr(O.indexOf(":")+A+e)}function d(e){c(P,"MessageCallback passed: {iframe: "+z.iframe.id+", message: "+e+"}"),N("messageCallback",{iframe:z.iframe,message:JSON.parse(e)}),c(P,"--")}function u(){var t=document.body.getBoundingClientRect(),n=z.iframe.getBoundingClientRect();return JSON.stringify({iframeHeight:n.height,iframeWidth:n.width,clientHeight:Math.max(document.documentElement.clientHeight,e.innerHeight||0),clientWidth:Math.max(document.documentElement.clientWidth,e.innerWidth||0),offsetTop:parseInt(n.top-t.top,10),offsetLeft:parseInt(n.left-t.left,10),scrollTop:e.pageYOffset,scrollLeft:e.pageXOffset})}function x(e,t){function n(){v("Send Page Info","pageInfo:"+u(),e,t)}k(n,32)}function E(){function i(t,n){function i(){j[o]?x(j[o].iframe,o):r()}["scroll","resize"].forEach(function(r){c(o,t+r+" listener for sendPageInfo"),n(e,r,i)})}function r(){i("Remove ",n)}var o=P;(function(){i("Add ",t)})(),j[o].stopPageInfo=r}function F(){j[P]&&j[P].stopPageInfo&&(j[P].stopPageInfo(),delete j[P].stopPageInfo)}function M(e){var t=e.getBoundingClientRect();return g(P),{x:Math.floor(Number(t.left)+Number(H.x)),y:Math.floor(Number(t.top)+Number(H.y))}}function C(t){var n=t?M(z.iframe):{x:0,y:0},i=function(){return{x:Number(z.width)+n.x,y:Number(z.height)+n.y}}();c(P,"Reposition requested from iFrame (offset x:"+n.x+" y:"+n.y+")"),e.top!==e.self?function(){e.parentIFrame?e.parentIFrame["scrollTo"+(t?"Offset":"")](i.x,i.y):l(P,"Unable to scroll to requested position, window.parentIFrame not found")}():function(){H=i,R(),c(P,"--")}()}function R(){!1!==N("scrollCallback",H)?f(P):h()}function I(t){var n=t.split("#")[1]||"",i=decodeURIComponent(n),r=document.getElementById(i)||document.getElementsByName(i)[0];r?function(){var e=M(r);c(P,"Moving to in page link (#"+n+") at x: "+e.x+" y: "+e.y),H={x:e.x,y:e.y},R(),c(P,"--")}():e.top!==e.self?function(){e.parentIFrame?e.parentIFrame.moveToAnchor(n):c(P,"In page link #"+n+" not found and window.parentIFrame not found")}():c(P,"In page link #"+n+" not found")}function N(e,t){return m(P,e,t)}function S(){j[P].firstRun=!1}var O=i.data,z={},P=null;"[iFrameResizerChild]Ready"===O?function(){for(var e in j)v("iFrame requested init",b(e),document.getElementById(e),e)}():function(){return T===(""+O).substr(0,L)&&O.substr(L).split(":")[0]in j}()?(z=function(){var e=O.substr(L).split(":");return{iframe:j[e[0]].iframe,id:e[0],height:e[1],width:e[2],type:e[3]}}(),P=W=z.id,!function(){var e=z.type in{true:1,false:1,undefined:1};return e&&c(P,"Ignoring init message from meta parent page"),e}()&&function(e){var t=!0;return j[e]||(t=!1,l(z.type+" No settings for "+e+". Message was: "+O)),t}(P)&&(c(P,"Received: "+O),function(){var e=!0;return null===z.iframe&&(l(P,"IFrame ("+z.id+") not found"),e=!1),e}()&&function(){var e=i.origin,t=j[P].checkOrigin;if(t&&""+e!="null"&&!function(){return t.constructor===Array?function(){var n=0,i=!1;for(c(P,"Checking connection is from allowed list of origins: "+t);n<t.length;n++)if(t[n]===e){i=!0;break}return i}():function(){var t=j[P].remoteHost;return c(P,"Checking connection is from: "+t),e===t}()}())throw new Error("Unexpected message received from: "+e+" for "+z.iframe.id+". Message was: "+i.data+". This error can be disabled by setting the checkOrigin: false option or by providing of array of trusted domains.");return!0}()&&function(){switch(j[P].firstRun&&S(),z.type){case"close":p(z.iframe);break;case"message":d(a(6));break;case"scrollTo":C(!1);break;case"scrollToOffset":C(!0);break;case"pageInfo":x(j[P].iframe,P),E();break;case"pageInfoStop":F();break;case"inPageLink":I(a(9));break;case"reset":_(z);break;case"init":r(),N("initCallback",z.iframe),N("resizedCallback",z);break;default:r(),N("resizedCallback",z)}}())):s(P,"Ignored: "+O)}function m(e,t,n){var i=null,r=null;if(j[e]){if("function"!=typeof(i=j[e][t]))throw new TypeError(t+" on iFrame["+e+"] is not a function");r=i(n)}return r}function p(e){var t=e.id;c(t,"Removing iFrame: "+t),e.parentNode.removeChild(e),m(t,"closedCallback",t),c(t,"--"),delete j[t]}function g(t){null===H&&(H={x:void 0!==e.pageXOffset?e.pageXOffset:document.documentElement.scrollLeft,y:void 0!==e.pageYOffset?e.pageYOffset:document.documentElement.scrollTop},c(t,"Get page position: "+H.x+","+H.y))}function f(t){null!==H&&(e.scrollTo(H.x,H.y),c(t,"Set page position: "+H.x+","+H.y),h())}function h(){H=null}function _(e){function t(){y(e),v("reset","reset",e.iframe,e.id)}c(e.id,"Size reset requested by "+("init"===e.type?"host page":"iFrame")),g(e.id),w(t,e,"reset")}function y(e){function t(t){e.iframe.style[t]=e[t]+"px",c(e.id,"IFrame ("+r+") "+t+" set to "+e[t]+"px")}function n(t){O||"0"!==e[t]||(O=!0,c(r,"Hidden iFrame detected, creating visibility listener"),E())}function i(e){t(e),n(e)}var r=e.iframe.id;j[r]&&(j[r].sizeHeight&&i("height"),j[r].sizeWidth&&i("width"))}function w(e,t,n){n!==t.type&&z?(c(t.id,"Requesting animation frame"),z(e)):e()}function v(e,t,n,i){function r(){var r=j[i].targetOrigin;c(i,"["+e+"] Sending msg to iframe["+i+"] ("+t+") targetOrigin: "+r),n.contentWindow.postMessage(T+t,r)}function o(){s(i,"["+e+"] IFrame("+i+") not found"),j[i]&&delete j[i]}i=i||n.id,j[i]&&function(){n&&"contentWindow"in n&&null!==n.contentWindow?r():o()}()}function b(e){return e+":"+j[e].bodyMarginV1+":"+j[e].sizeWidth+":"+j[e].log+":"+j[e].interval+":"+j[e].enablePublicMethods+":"+j[e].autoResize+":"+j[e].bodyMargin+":"+j[e].heightCalculationMethod+":"+j[e].bodyBackground+":"+j[e].bodyPadding+":"+j[e].tolerance+":"+j[e].inPageLinks+":"+j[e].resizeFrom+":"+j[e].widthCalculationMethod}function x(e,n){function i(){var e=n&&n.id||B.id+N++;return null!==document.getElementById(e)&&(e+=N++),e}function r(){var t=j[d].firstRun,n=j[d].heightCalculationMethod in P;!t&&n&&_({iframe:e,height:0,width:0,type:"init"})}function o(e){if("object"!=typeof e)throw new TypeError("Options is not an object")}function a(e){for(var t in B)B.hasOwnProperty(t)&&(j[d][t]=e.hasOwnProperty(t)?e[t]:B[t])}function s(e){return""===e||"file://"===e?"*":e}var d=function(t){return W=t,""===t&&(e.id=t=i(),S=(n||{}).log,W=t,c(t,"Added missing iframe ID: "+t+" ("+e.src+")")),t}(e.id);!function(){return d in j&&"iFrameResizer"in e}()?(function(t){t=t||{},j[d]={firstRun:!0,iframe:e,remoteHost:e.src.split("/").slice(0,3).join("/")},o(t),a(t),j[d].targetOrigin=!0===j[d].checkOrigin?s(j[d].remoteHost):"*"}(n),function(){c(d,"IFrame scrolling "+(j[d].scrolling?"enabled":"disabled")+" for "+d),e.style.overflow=!1===j[d].scrolling?"hidden":"auto",e.scrolling=!1===j[d].scrolling?"no":"yes"}(),function(){function t(t){1/0!==j[d][t]&&0!==j[d][t]&&(e.style[t]=j[d][t]+"px",c(d,"Set "+t+" = "+j[d][t]+"px"))}function n(e){if(j[d]["min"+e]>j[d]["max"+e])throw new Error("Value for min"+e+" can not be greater than max"+e)}n("Height"),n("Width"),t("maxHeight"),t("minHeight"),t("maxWidth"),t("minWidth")}(),function(){("number"==typeof j[d].bodyMargin||"0"===j[d].bodyMargin)&&(j[d].bodyMarginV1=j[d].bodyMargin,j[d].bodyMargin=j[d].bodyMargin+"px")}(),function(n){function i(){v("iFrame.onload",n,e),r()}t(e,"load",i),v("init",n,e)}(b(d)),function(){Function.prototype.bind&&(j[d].iframe.iFrameResizer={close:p.bind(null,j[d].iframe),resize:v.bind(null,"Window resize","resize",j[d].iframe),moveToAnchor:function(e){v("Move to anchor","inPageLink:"+e,j[d].iframe,d)},sendMessage:function(e){e=JSON.stringify(e),v("Send Message","message:"+e,j[d].iframe,d)}})}()):l(d,"Ignored iFrame, already setup.")}function k(e,t){null===U&&(U=setTimeout(function(){U=null,e()},t))}function E(){function t(){for(var e in j)!function(e){function t(t){return"0px"===j[e].iframe.style[t]}(function(e){return null!==e.offsetParent})(j[e].iframe)&&(t("height")||t("width"))&&v("Visibility change","resize",j[e].iframe,e)}(e)}function n(e){c("window","Mutation observed: "+e[0].target+" "+e[0].type),k(t,16)}var i=e.MutationObserver||e.WebKitMutationObserver;i&&function(){var e=document.querySelector("body"),t={attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0};new i(n).observe(e,t)}()}function F(e){function t(){C("Window "+e,"resize")}c("window","Trigger event: "+e),k(t,16)}function M(){function e(){C("Tab Visable","resize")}"hidden"!==document.visibilityState&&(c("document","Trigger event: Visiblity change"),k(e,16))}function C(e,t){for(var n in j)(function(e){return"parent"===j[e].resizeFrom&&j[e].autoResize&&!j[e].firstRun})(n)&&v(e,t,document.getElementById(n),n)}function R(){t(e,"message",u),t(e,"resize",function(){F("resize")}),t(document,"visibilitychange",M),t(document,"-webkit-visibilitychange",M),t(e,"focusin",function(){F("focus")}),t(e,"focus",function(){F("focus")})}function I(){function e(e,n){n&&(function(){if(!n.tagName)throw new TypeError("Object is not a valid DOM element");if("IFRAME"!==n.tagName.toUpperCase())throw new TypeError("Expected <IFRAME> tag, found <"+n.tagName+">")}(),x(n,e),t.push(n))}var t;return i(),R(),function(n,i){switch(t=[],typeof i){case"undefined":case"string":Array.prototype.forEach.call(document.querySelectorAll(i||"iframe"),e.bind(void 0,n));break;case"object":e(n,i);break;default:throw new TypeError("Unexpected data type ("+typeof i+")")}return t}}var N=0,S=!1,O=!1,A="message".length,T="[iFrameSizer]",L=T.length,H=null,z=e.requestAnimationFrame,P={max:1,scroll:1,bodyScroll:1,documentElementScroll:1},j={},U=null,W="Host Page",B={autoResize:!0,bodyBackground:null,bodyMargin:null,bodyMarginV1:8,bodyPadding:null,checkOrigin:!0,inPageLinks:!1,enablePublicMethods:!0,heightCalculationMethod:"bodyOffset",id:"iFrameResizer",interval:32,log:!1,maxHeight:1/0,maxWidth:1/0,minHeight:0,minWidth:0,resizeFrom:"parent",scrolling:!1,sizeHeight:!0,sizeWidth:!1,tolerance:0,widthCalculationMethod:"scroll",closedCallback:function(){},initCallback:function(){},messageCallback:function(){l("MessageCallback function not defined")},resizedCallback:function(){},scrollCallback:function(){return!0}};e.jQuery&&function(e){e.fn.iFrameResize=function(e){return this.filter("iframe").each(function(t,n){x(n,e)}).end()}}(jQuery),"function"==typeof define&&define.amd?define([],I):"object"==typeof module&&"object"==typeof module.exports?module.exports=I():e.iFrameResize=e.iFrameResize||I()}(window||{});
