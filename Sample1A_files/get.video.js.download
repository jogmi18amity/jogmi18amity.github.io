/*! updated; 04-10-2018 03:45 PM **/


Modulr.define("core.video:models/get.video",["require","jquery","lodash","helper","config"],function(require,$,_,Helper,config){var FEED_STACK={};return function(){function executeStack(videoId){if(FEED_STACK[videoId].stack.length>0)for(;FEED_STACK[videoId].stack.length>0;){var fn=FEED_STACK[videoId].stack.shift();fn(FEED_STACK[videoId].data)}}function normalize(data){var obj={};obj.raw=data;var channel=data.channel,item=channel.item;return obj.image=item["media-group"]["media-thumbnail"]["@attributes"],obj.requires_auth=function(restrict,status){var res=!1;return restrict&&"string"==typeof restrict&&"urn:protected"===restrict?res=!0:restrict&&"object"==typeof restrict&&restrict["@attributes"]?"deny"!==restrict["@attributes"].relationship&&"urn:protected"!==restrict["#text"]||(res=!0):status&&status["@attributes"]&&"blocked"===status["@attributes"].state&&(res=!0),res}(item["media-restriction"],item["media-status"]),obj.norm={},item["dc-date"]&&(obj.norm["dc-date"]=setVideoDateTime(item["dc-date"])),obj}function setVideoDateTime(val){var sp=val.split("T"),date=sp[0],time=sp[1].split("-")[0];return date=date.split("-"),date=[date[1],date[2],date[0]].join("/"),new Date([date,time].join(" "))}var args=arguments,domain=null,callback=null,videoId=args[0];if("object"==typeof args[1]?(domain=args[1].domain||null,args[2]&&"function"==typeof args[2]&&(callback=args[2])):"function"==typeof args[1]&&(callback=args[1]),!(!videoId||!callback))if(FEED_STACK[videoId])FEED_STACK[videoId].data?callback(FEED_STACK[videoId].data):FEED_STACK[videoId].stack.push(callback);else{FEED_STACK[videoId]={data:null,stack:[callback]};var url=Helper.getVideoFeedUrl(videoId,{domain:domain||null});$.ajax({url:url,dataType:"jsonp",jsonpCallback:"uid_"+videoId,cache:!0}).done(function(data){var norm=normalize(data);FEED_STACK[videoId].data=norm,executeStack(videoId)})}}});